{
  "report": {
    "id": "1346d146-fbcf-4df4-95a1-6df375664669",
    "remote_id": "ac316089-239e-4127-8deb-ab501b00304b",
    "environment": "d37a6d84-d569-46a6-b227-68e6d0138f77",
    "requested": "2020-08-28T14:14:07.716567",
    "started": "2020-08-28T14:14:07.720933",
    "completed": "2020-08-28T14:14:08.471243",
    "do_export": false,
    "force_update": false,
    "metadata": {
      "type": "lsm",
      "message": "Recompile model because state transition (validate)",
      "trigger": "AUTO",
      "to_state": "acknowledged",
      "transfer": {
        "auto": true,
        "error": "rejected",
        "source": "start",
        "target": "acknowledged",
        "validate": true,
        "on_delete": false,
        "on_update": false,
        "config_name": null,
        "description": "initial validation",
        "api_set_state": false,
        "resource_based": false,
        "error_operation": null,
        "target_operation": null
      },
      "event_type": "AUTO_TRANSITION",
      "from_state": "start",
      "error_state": "rejected",
      "instance_id": "3ae02d7e-eac2-4553-b87f-1359b343e986",
      "service_entity": "test_service",
      "event_correlation_id": "ac316089-239e-4127-8deb-ab501b00304b",
      "from_instance_version": "1"
    },
    "environment_variables": {
      "inmanta_instance_id": "3ae02d7e-eac2-4553-b87f-1359b343e986",
      "inmanta_model_state": "candidate",
      "inmanta_instance_version": "1"
    },
    "success": false,
    "handled": true,
    "compile_data": "{\"errors\": [{\"type\": \"inmanta.ast.DoubleSetException\", \"message\": \"value set twice:\\n\\told value: 1\\n\\t\\tset at ./main.cf:30\\n\\tnew value: 0\\n\\t\\tset at ./main.cf:29\\n\", \"category\": \"runtime_error\", \"location\": {\"uri\": \"./main.cf\", \"range\": {\"end\": {\"line\": 29, \"character\": 0}, \"start\": {\"line\": 28, \"character\": 0}}}}]}",
    "reports": [
      {
        "id": "9c1aa62c-6654-44bf-b122-f0b7259b7cf3",
        "started": "2020-08-28T14:14:07.721554",
        "completed": "2020-08-28T14:14:07.724970",
        "command": "",
        "name": "Init",
        "errstream": "",
        "outstream": "Using extra environment variables during compile inmanta_model_state='candidate', inmanta_instance_id='3ae02d7e-eac2-4553-b87f-1359b343e986', inmanta_instance_version='1'\n",
        "returncode": 0,
        "compile": "1346d146-fbcf-4df4-95a1-6df375664669"
      },
      {
        "id": "9ff07c4e-91a9-4e98-89c3-b83d7736b92e",
        "started": "2020-08-28T14:14:07.725864",
        "completed": "2020-08-28T14:14:08.469197",
        "command": "lsm/venv/bin/python -m inmanta.app -vvv export -X -e d37a6d84-d569-46a6-b227-68e6d0138f77 --server_address localhost --server_port 8888 --metadata {\"message\": \"Recompile model because state transition (validate)\", \"type\": \"lsm\", \"service_entity\": \"test_service\", \"instance_id\": \"3ae02d7e-eac2-4553-b87f-1359b343e986\", \"from_instance_version\": \"1\", \"error_state\": \"rejected\", \"from_state\": \"start\", \"to_state\": \"acknowledged\", \"event_type\": \"AUTO_TRANSITION\", \"trigger\": \"AUTO\", \"event_correlation_id\": \"ac316089-239e-4127-8deb-ab501b00304b\", \"transfer\": {\"source\": \"start\", \"target\": \"acknowledged\", \"error\": \"rejected\", \"on_update\": false, \"on_delete\": false, \"api_set_state\": false, \"resource_based\": false, \"auto\": true, \"validate\": true, \"config_name\": null, \"description\": \"initial validation\", \"target_operation\": null, \"error_operation\": null}} --export-compile-data --export-compile-data-file /tmp/tmphwpz66_n -j /tmp/tmp7pwqbwow",
        "name": "Recompiling configuration model",
        "errstream": "Traceback (most recent call last):\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/app.py\", line 701, in app\n    options.func(options)\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/app.py\", line 506, in export\n    raise exp\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/app.py\", line 492, in export\n    (types, scopes) = do_compile()\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/compiler/__init__.py\", line 77, in do_compile\n    compiler.handle_exception(e)\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/compiler/__init__.py\", line 249, in handle_exception\n    self._handle_exception_export(e)\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/compiler/__init__.py\", line 255, in _handle_exception_export\n    raise exception\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/compiler/__init__.py\", line 247, in handle_exception\n    self._handle_exception_datatrace(exception)\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/compiler/__init__.py\", line 259, in _handle_exception_datatrace\n    raise exception\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/compiler/__init__.py\", line 73, in do_compile\n    success = sched.run(compiler, statements, blocks)\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/execute/scheduler.py\", line 298, in run\n    next.execute()\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/execute/runtime.py\", line 676, in execute\n    raise e\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/execute/runtime.py\", line 673, in execute\n    self._unsafe_execute()\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/execute/runtime.py\", line 668, in _unsafe_execute\n    self.result.set_value(value, self.expression.location)\n  File \"lsm/venv/lib/python3.6/site-packages/inmanta/execute/runtime.py\", line 130, in set_value\n    raise DoubleSetException(self, None, value, location)\ninmanta.ast.DoubleSetException: value set twice:\n\told value: 1\n\t\tset at ./main.cf:30\n\tnew value: 0\n\t\tset at ./main.cf:29\n (reported in x = 0 (./main.cf:29))\n",
        "outstream": "inmanta.env              INFO    Creating new virtual environment in ./.env\ninmanta.compiler         DEBUG   Starting compile\ninmanta.module           WARNING Module unittest is not version controlled, we recommend you do this as soon as possible.\ninmanta.module           INFO    verifying project\ninmanta.module           DEBUG   Loading module inmanta_plugins.lsm.typedef\ninmanta.loader           DEBUG   Loading module: inmanta_plugins\ninmanta.loader           DEBUG   Loading module: inmanta_plugins.lsm\ninmanta.protocol.endpointsDEBUG   Start transport for client compiler\ninmanta.loader           DEBUG   Loading module: inmanta_plugins.lsm.typedef\ninmanta.module           DEBUG   Loading module inmanta_plugins.lsm\ninmanta.module           DEBUG   Loading module inmanta_plugins.lsm.allocation\ninmanta.loader           DEBUG   Loading module: inmanta_plugins.lsm.allocation\ninmanta.module           DEBUG   Loading module inmanta_plugins.std\ninmanta.loader           DEBUG   Loading module: inmanta_plugins.std\ninmanta.module           DEBUG   Loading module inmanta_plugins.std.resources\ninmanta.loader           DEBUG   Loading module: inmanta_plugins.std.resources\ninmanta.module           DEBUG   Loading module inmanta_plugins.unittest\ninmanta.loader           DEBUG   Loading module: inmanta_plugins.unittest\ninmanta.execute.schedulerDEBUG   Iteration 1 (e: 40, w: 0, p: 0, done: 0, time: 0.006450)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> <inmanta.execute.runtime.AttributeVariable object at 0x7fe85ae9a6d8>.None.\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> ListVariable lsm::LifecycleStateMachine (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:238) lsm::LifecycleStateMachine.transfers = [lsm::StateTransfer 7fe85ad94288, lsm::StateTransfer 7fe85ad943a8, lsm::StateTransfer 7fe85ad944c8, lsm::StateTransfer 7fe85ad945e8, lsm::StateTransfer 7fe85ad94708, lsm::StateTransfer 7fe85ad94828, lsm::StateTransfer 7fe85ad94948, lsm::StateTransfer 7fe85ad94a68, lsm::StateTransfer 7fe85ad94b88, lsm::StateTransfer 7fe85ad94ca8, lsm::StateTransfer 7fe85ad94dc8, lsm::StateTransfer 7fe85ad94ee8, lsm::StateTransfer 7fe85adbb048, lsm::StateTransfer 7fe85adbb168, lsm::StateTransfer 7fe85adbb288, lsm::StateTransfer 7fe85adbb3a8, lsm::StateTransfer 7fe85adbb4c8, lsm::StateTransfer 7fe85adbb5e8, lsm::StateTransfer 7fe85adbb708, lsm::StateTransfer 7fe85adbb828, lsm::StateTransfer 7fe85adbb948, lsm::StateTransfer 7fe85adbba68, lsm::StateTransfer 7fe85adbbb88, lsm::StateTransfer 7fe85adbbca8, lsm::StateTransfer 7fe85adbbdc8, lsm::StateTransfer 7fe85adbbee8, lsm::StateTransfer 7fe85ad61048, lsm::StateTransfer 7fe85ad61168, lsm::StateTransfer 7fe85ad61288].None.\ninmanta.execute.schedulerDEBUG   Iteration 2 (e: 1, w: 42, p: 265, done: 1469, time: 0.022688)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:170) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 3 (e: 1, w: 0, p: 292, done: 1470, time: 0.000727)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:174) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 4 (e: 1, w: 0, p: 291, done: 1471, time: 0.000464)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:179) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 5 (e: 1, w: 0, p: 290, done: 1472, time: 0.000462)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:180) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 6 (e: 1, w: 0, p: 289, done: 1473, time: 0.000503)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:193) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 7 (e: 1, w: 0, p: 288, done: 1474, time: 0.000605)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:194) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 8 (e: 1, w: 0, p: 287, done: 1475, time: 0.000626)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:198) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 9 (e: 1, w: 0, p: 286, done: 1476, time: 0.000725)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:211) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 10 (e: 1, w: 0, p: 285, done: 1477, time: 0.000670)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:214) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 11 (e: 1, w: 0, p: 284, done: 1478, time: 0.000737)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:215) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 12 (e: 1, w: 0, p: 283, done: 1479, time: 0.000806)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:218) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 13 (e: 1, w: 0, p: 282, done: 1480, time: 0.000817)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:219) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 14 (e: 1, w: 0, p: 281, done: 1481, time: 0.000849)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:220) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 15 (e: 1, w: 0, p: 280, done: 1482, time: 0.000861)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:221) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 16 (e: 1, w: 0, p: 279, done: 1483, time: 0.000965)\ninmanta.ast.statements.callDEBUG   Unset value in python code in plugin <inmanta.ast.statements.call.PluginFunction object at 0x7fe85ae81c88> OptionVariable lsm::StateTransfer (instantiated at /tmp/tmpgxqh21__/libs/lsm/model/fsm.cf:222) lsm::StateTransfer.error = None.None.\ninmanta.execute.schedulerDEBUG   Moved zerowaiters to waiters\ninmanta.execute.schedulerDEBUG   Iteration 17 (e: 1, w: 0, p: 278, done: 1484, time: 0.000906)\nasyncio                  DEBUG   Using selector: EpollSelector\ninmanta.protocol.rest.clientDEBUG   Getting config in section compiler_rest_transport\ninmanta.protocol.rest.clientDEBUG   Calling server GET http://localhost:8888/lsm/v1/service_inventory/test_service\ninmanta.protocol.endpointsDEBUG   Start transport for client compiler\ninmanta.protocol.rest.clientDEBUG   Getting config in section compiler_rest_transport\ninmanta.protocol.rest.clientDEBUG   Calling server POST http://localhost:8888/api/v2/reserve_version\ninmanta.export           WARNING Compilation of model failed.\ninmanta.export           WARNING Empty deployment model.\n",
        "returncode": 1,
        "compile": "1346d146-fbcf-4df4-95a1-6df375664669"
      }
    ]
  }
}